<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Template</title>
	<style type="text/css">
	canvas{
		border:1px solid gray;
	}
	
	#audioControls{
		display:none;
	}
	</style>
	<script src="js/utilities.js"></script>
	<script>
		"use strict";
		(function(){
		var canvas, ctx;
		var CANVAS_WIDTH = 640, CANVAS_HEIGHT = 480;
		// CONSTANTS
		var GAME_STATE_BEGIN = 0;
		var GAME_STATE_DEFAULT = 1;
		var GAME_STATE_ROUND_OVER = 2;
		var GAME_STATE_END = 3;
		var GAME_STATE_REPEAT_LEVEL = 4;

		// one new variable
		
		var gameState = GAME_STATE_BEGIN;
		var roundScore;
		var totalScore = 0;

		var	bubbles = [];
		var paused = false;
		var animationID;
		
		var lastTime = 0;
		
		var bgAudio;
		var winAudio;
		var effectAudio;
		var currentEffect = 0;
		var currentDirection = 1;
		var effectSounds = ["1.mp3", "2.mp3", "3.mp3", "4.mp3", "5.mp3", "6.mp3", "7.mp3", "8.mp3"];
		
		var winPlayed;
		
		var gameSpeed = 1;
		
		window.onload = init;
	
		function init(){
			console.log("init called");
			canvas = document.querySelector("canvas");
			ctx = canvas.getContext("2d");
			
			bgAudio = document.querySelector('#bgAudio');
			bgAudio.volume = 0.25;
			
			winAudio = document.querySelector('#winAudio');
			winAudio.volume = 0.25;
			
			effectAudio = document.querySelector('#effectAudio');
			effectAudio.volume = 0.3;
			
			
			
			update();
		}
		
		function reset()
		{
		
		}
		
		function update()
		{
			
		}
		
		function drawText(string, x, y, size, color)
		{
			ctx.font = 'bold ' + size + 'px Monospace';
			ctx.fillStyle = color;
			ctx.fillText(string, x, y);
		}
		
		function doMouseDown(e)
		{
			
		}
		
		function bubbleClicked(bubble)
		{

		}
		
		function drawPauseScreen()
		{
			ctx.save();
			ctx.fillStyle = "black";
			ctx.fillRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);
			ctx.textAlign = "center";
			ctx.textBaseline = "middle";
			drawText("... PAUSED ...", CANVAS_WIDTH/2, CANVAS_HEIGHT/2, 60, "white");
			ctx.restore();
		}
		
		function moveCircles(dt)
		{

		}
		
		function checkForCollisions()
		{
			
		}
		
		function drawBubbles()
		{

		}
		
		function drawHUD()
		{
			
		}
		
		function calculateDeltaTime()
		{
			var now;
			var fps;
			now = (+new Date);
			fps = 1000 / (now - lastTime);
			fps = clamp(fps, 12, 60);
			lastTime = now;
			return 1/fps;
		}
		
		function stopAudio()
		{
			bgAudio.pause();
			bgAudio.currentTime = 0;
		}
		
		function playEffect()
		{
			effectAudio.src = "media/" + effectSounds[currentEffect];
			effectAudio.play();
			
			currentEffect = currentEffect + currentDirection;
			if(currentEffect == effectSounds.length || currentEffect == -1)
			{
				currentDirection *= -1;
				currentEffect += currentDirection;
			}
		}
		}())
	</script>
</head>
<body>
	<canvas width="640" height="480">
		
	</canvas>
	<section id="audioControls">
		<audio id="bgAudio" src="media/background.mp3" controls loop></audio>
		<audio id="effectAudio" controls></audio>
		<audio id="winAudio" src="media/level-complete.mp3" controls></audio>
	</section>
</body>
</html>
